=>INNER JOIN (Simple Join)

DROP TABLE IF EXISTS orders;

*****
customer id is a primary key (PK) in CUSTOMER table
order id is a primary key (PK) in ORDERS table
customer_id is a foreign key (FK) in ORDERS table

CREATE TABLE IF NOT EXISTS customer(
	id INT AUTO_INCREMENT PRIMARY KEY,
	firstname VARCHAR(20),
	lastname VARCHAR(20),
	email VARCHAR(50)
);

INSERT INTO customer(firstname,lastname,email)
VALUES('aung','aung','aungaung@gmail.com'),
('maung','maung','maungmaung@gmail.com'),
('kyaw','kyaw','kyawkyaw@gmail.com'),
('zaw','zaw','zawzaw@gmail.com'),
('su','su','susu@gmail.com'),
('aye','aye','ayeaye@gmail.com'),
('yu','yu','yuyu@gmail.com');

______________________________________________________________
#26 Jan 2022

CREATE TABLE IF NOT EXISTS orders(
	id INT AUTO_INCREMENT PRIMARY KEY,
	orderdate DATE,
	amount DECIMAL(10,2),
	customer_id INT,
	FOREIGN KEY(customer_id) REFERENCES customer(id)
);


DESC orders;

INSERT INTO orders(orderdate,amount,customer_id)
VALUES('2021/02/10',99.99,1),
('2021/10/11',75.35,1),
('2021/06/12',100.26,3),
('2021/07/13',13.25,2),
('2021/01/14',45,3);

SELECT * FROM orders;

SELECT * FROM customer;

*error (Bcoz of customer_id 20 doesn't have in customer table id)
INSERT INTO orders(orderdate,amount,customer_id)
VALUES('2021/02/10',99.99,20);

SELECT * FROM orders;


INSERT INTO orders(orderdate,amount,customer_id)
VALUES('2021/10/10',80.50,7);

*error (Bcoz of customer id 9 doesn't have in customer table)
INSERT INTO orders(orderdate,amount,customer_id)
VALUES('2021/10/10',90,8),
('2021/10/10',100,9);

*error (Bcoz of customer_id is FK in orders table)
DROP TABLE IF EXISTS customer;



SELECT * FROM customer;

*error (Bcoz of datas in orders table linked with customer table)
DELETE FROM customer WHERE id=2;
DELETE FROM customer WHERE id=1;

*Can Delete (Bcoz of customer id 4,5 are not yet recorded in orders table)
DELETE FROM customer WHERE id=4;
DELETE FROM customer WHERE id=5;

*error (Bcoz of customer_id is Foreign Key in orders table)  
[ if u want to delete early to drop References table]
DROP TABLE IF EXISTS customer;

*** (If u want to delete tables   >>> early to Delete Main Table [Have References Table] )
DROP TABLE IF EXISTS orders;
DROP TABLE IF EXISTS customer;
__________________________________________________________________________

CREATE TABLE IF NOT EXISTS customer(
	id INT AUTO_INCREMENT PRIMARY KEY,
	firstname VARCHAR(20),
	lastname VARCHAR(20),
	email VARCHAR(50)
);


CREATE TABLE IF NOT EXISTS orders(
	id INT AUTO_INCREMENT PRIMARY KEY,
	orderdate DATE,
	amount DECIMAL(10,2),
	customer_id INT
);


INSERT INTO customer(firstname,lastname,email)
VALUES('aung','aung','aungaung@gmail.com'),
('maung','maung','maungmaung@gmail.com'),
('kyaw','kyaw','kyawkyaw@gmail.com'),
('zaw','zaw','zawzaw@gmail.com'),
('su','su','susu@gmail.com'),
('aye','aye','ayeaye@gmail.com'),
('yu','yu','yuyu@gmail.com');


INSERT INTO orders(orderdate,amount,customer_id)
VALUES('2021/02/10',99.99,1),
('2021/10/11',75.35,1),
('2021/06/12',100.26,3),
('2021/07/13',13.25,2),
('2021/01/14',45,3);

SELECT * FROM customer;
SELECT * FROM orders;





Method 1 (IMPLICIT INNER JOIN)
SELECT * FROM customer,orders
WHERE customer.id = orders.customer_id;

SELECT * FROM customer,orders
WHERE orders.customer_id = customer.id;


SELECT * FROM orders,customer
WHERE orders.customer_id = customer.id;

SELECT * FROM orders,customer
WHERE customer.id = orders.customer_id;



Method 2 (EXPLICIT INNER JOIN)  [Table datas >>> 1st,2nd view are base on tablename 1st and 2nd]
SELECT * FROM customer
JOIN orders
ON customer.id = orders.customer_id;

SELECT * FROM customer
JOIN orders
ON orders.customer_id = customer.id;


SELECT * FROM orders
JOIN customer
ON orders.customer_id = customer.id;

SELECT * FROM orders
JOIN customer
ON customer.id = orders.customer_id;



Method 3 (EXPLICIT INNER JOIN)
SELECT * FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id;

SELECT * FROM customer
INNER JOIN orders
ON orders.customer_id = customer.id;


SELECT * FROM orders
INNER JOIN customer
ON orders.customer_id = customer.id;

SELECT * FROM orders
INNER JOIN customer
ON customer.id = orders.customer_id;


26IN
_____________________________________________________________________
#jan 30 2022

(Method 1)
SELECT * FROM orders,customer
WHERE customer.id = orders.customer_id;

SELECT firstname,lastname,orderdate,amount 
FROM customer,orders
WHERE customer.id = orders.customer_id;

SELECT firstname,lastname,orderdate,amount 
FROM customer,orders
WHERE orders.customer_id = customer.id;

SELECT firstname,lastname,orderdate,amount 
FROM orders,customer
WHERE orders.customer_id = customer.id;

SELECT firstname,lastname,orderdate,amount 
FROM orders,customer
WHERE customer.id = orders.customer_id;



(Method 2)
SELECT firstname,lastname,orderdate,amount 
FROM customer
JOIN orders
ON customer.id = orders.customer_id;

SELECT firstname,lastname,orderdate,amount 
FROM customer
JOIN orders
ON orders.customer_id = customer.id;

SELECT firstname,lastname,orderdate,amount 
FROM orders
JOIN customer
ON orders.customer_id = customer.id;

SELECT firstname,lastname,orderdate,amount 
FROM orders
JOIN customer
ON customer.id = orders.customer_id;





(Method 3)
SELECT firstname,lastname,orderdate,amount 
FROM customer
INNER JOIN orders
ON customer_id = orders.customer.id;

SELECT firstname,lastname,orderdate,amount 
FROM customer
INNER JOIN orders
ON orders.customer_id = customer.id;

SELECT firstname,lastname,orderdate,amount 
FROM orders
INNER JOIN customer
ON orders.customer_id = customer.id;

SELECT firstname,lastname,orderdate,amount 
FROM orders
INNER JOIN customer
ON customer.id = orders.customer_id;
______________________________________________________________________

=>ORDER BY    EXERCISE

SELECT firstname,lastname,orderdate,amount 
FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id
ORDER BY orderdate DESC;

SELECT firstname,lastname,orderdate,amount 
FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id
ORDER BY orderdate ASC;

SELECT firstname,lastname,orderdate,amount 
FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id
ORDER BY amount ASC;                (Default = ASC)

SELECT firstname,lastname,orderdate,amount 
FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id
ORDER BY  amount DESC;




SELECT firstname,lastname,orderdate,amount AS 'TotalAmount'
FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id
ORDER BY TotalAmount DESC;

SELECT firstname,lastname,orderdate,amount AS 'total_amount'
FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id
ORDER BY total_amount DESC;

SELECT firstname,lastname,orderdate,amount AS 'Total Amount'
FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id
ORDER BY 'Total Amount' DESC;

SELECT firstname,lastname,orderdate,amount AS 'Total_Amount'
FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id
ORDER BY 'Total_Amount' DESC;

*error  (Bcoz of '' left)
SELECT firstname,lastname,orderdate,amount AS 'Total Amount'
FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id
ORDER BY Total Amount DESC;

________________________________________________________________
=>GROUP BY  Inner Join

SELECT firstname,lastname,orderdate,amount
FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id;

SELECT firstname,lastname,orderdate,amount
FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id
GROUP BY orders.customer_id;

SELECT firstname,lastname,orderdate,SUM(amount)
FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id
GROUP BY orders.customer_id;

SELECT firstname,lastname,orderdate,SUM(amount),COUNT(*)
FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id
GROUP BY orders.customer_id;

SELECT firstname,lastname,orderdate,SUM(amount),COUNT(*) AS 'TotalOrder'
FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id
GROUP BY orders.customer_id;

SELECT firstname,lastname,orderdate,SUM(amount) AS 'TotalAmount',COUNT(*) AS 'TotalOrder'
FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id
GROUP BY orders.customer_id
ORDER BY TotalAmount ASC;

SELECT firstname,lastname,orderdate,SUM(amount) AS 'TotalAmount',COUNT(*) AS 'TotalOrder'
FROM customer
INNER JOIN orders
ON customer.id = orders.customer_id
GROUP BY orders.customer_id
ORDER BY TotalAmount DESC;
_______________________________________________________________________________________________

